# ë¹„ë™ê¸°

ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” ì–¼ë§ˆë‚˜ ê±¸ë¦´ì§€ ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ìš”ì†Œê°€ ë§ë‹¤. ëŒ€í‘œì ìœ¼ë¡œëŠ” ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°ì™€ ì„œë²„ API ì‘ë‹µ, íŒŒì¼ ì¡°íšŒ ë“±ì´ ìˆë‹¤. ì´ëŸ¬í•œ ìœ í˜•ì˜ ì‘ì—…ë“¤ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•  ë•Œ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤ë©´ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì§€ë„ ëª»í•˜ê³  **ëª¨ë“  ì‘ì—…ì´ ë§ˆë¬´ë¦¬ë  ë•Œê¹Œì§€ ë¬´í•œì • ëŒ€ê¸°**í•˜ê²Œ ëœë‹¤. ì´ê±´ ë‹¹ì—°í•˜ê²Œë„ ë„ˆë¬´ ë¹„íš¨ìœ¨ì ì´ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ë©€í‹° ìŠ¤ë ˆë“œì˜ ì–¸ì–´ì˜€ë‹¤ë©´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì— í•´ë‹¹ ì‘ì—…ì„ ë„˜ê¸°ê³ , ì‚¬ìš©ìì˜ interactionì„ í•  ìˆ˜ ìˆì—ˆê² ì§€ë§Œ ì•ˆíƒ€ê¹ê²Œë„ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” **ì‹±ê¸€ ìŠ¤ë ˆë“œ ì–¸ì–´**ì´ë‹¤.

ì´ëŸ¬í•œ í•œê³„ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ Event Loopê°€ ë‚˜íƒ€ë‚˜ê²Œ ë˜ì—ˆë‹¤. í•´ê²° ë°©ë²•ì€ ê½¤ ë‹¨ìˆœí•˜ë‹¤. â€˜ì§€ê¸ˆâ€™ì´ ì•„ë‹Œ **â€˜ë‚˜ì¤‘ì—â€™** ì²˜ë¦¬í•˜ê² ë‹¤ëŠ” ì „ëµì´ë‹¤. ë‚˜ì¤‘ì— ì²˜ë¦¬í•˜ëŠ” ì½”ë“œëŠ” `ajax`, `setTimeout`ê³¼ ê°™ì€ Web APIì´ë‹¤.



1. Web APIë¥¼ ì‹¤í–‰í•˜ë©´ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. [Web APIëŠ” ì–´ë–»ê²Œ ë™ì‘í•˜ì§€?](##Web API)
2. ì‘ì—…ì´ ì™„ë£Œë˜ë©´ **callback** í•¨ìˆ˜ë¥¼ callback queueì— ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë„£ì–´ì¤€ë‹¤.
3. ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ëª¨ë“  ì½”ë“œë¥¼ ë‹¤ ì‹¤í–‰í•´ì„œ call stackì´ ë¹„ê²Œ ë˜ë©´, callback queueì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ í•˜ë‚˜ì”© êº¼ë‚´ì–´ **â€˜ë‚˜ì¤‘ì—â€™** ì‹¤í–‰í•˜ê²Œ ëœë‹¤.

ì´ê±¸ ì´ë¯¸ì§€ë¡œ í‘œí˜„í•˜ìë©´ ì•„ë˜ì™€ ê°™ë‹¤.
![42eatw03fcha0e1qcrf0](https://github.com/kjhwert/blogs/assets/40383255/496749e8-267e-4e30-b962-f1de18cdf0c7)

í•´ë‹¹ ì´ë¯¸ì§€ì—ëŠ” callback queueê°€ microtask queue, macrotask queue ë‘ ê°€ì§€ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆì§€ë§Œ ì´ ë¶€ë¶„ì€ ì´í›„ì— ì„¤ëª…í•˜ê² ë‹¤.

# Callback

â€˜ì§€ê¸ˆâ€™ì´ ì•„ë‹Œ â€˜ë‚˜ì¤‘ì—â€™ê°€ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ì „ëµì´ë¼ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆë‹¤. ë‚˜ì¤‘ì— ëŒì•„ì˜¤ê¸° ìœ„í•´ ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” callback í•¨ìˆ˜ë¥¼ ë‹¬ì•„ì„œ í™œìš©í•˜ê²Œ ëœë‹¤. ë°”ë¡œ 1ì„¸ëŒ€ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ë²•ì¸ ê²ƒì´ë‹¤. 
callbackì€ ë¹„ë™ê¸°ë¥¼ í‘œí˜„í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì´ê³  ì¼ë°˜ì ì¸ ë°©ë²•ì´ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°œë°œìëŠ” ì˜ë„í•˜ì§€ ì•Šì•„ë„ ìì—°ìŠ¤ëŸ½ê²Œ callback íŒ¨í„´ì„ í™œìš©í•´ì„œ íë¦„ì„ ì œì–´í•˜ê³¤ í•œë‹¤.
ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ í•¨ìˆ˜ê°€ ì¼ê¸‰ í•¨ìˆ˜ì¸ ë•ë¶„ì— ì´ëŸ¬í•œ íŒ¨í„´ì´ ìƒê²¨ë‚  ìˆ˜ ìˆì—ˆê³ , ì—¬ì „íˆ ë¹„ë™ê¸°ë¥¼ í‘œí˜„í•˜ê¸°ì— ì ì ˆí•˜ê³  ìœ ìš©í•œ í‘œí˜„ì´ë‹¤. í•˜ì§€ë§Œ, ë¹„ë™ê¸°ì˜ depthê°€ ê¹Šì–´ì§€ë©´ ìƒê°ì€ ì¡°ê¸ˆ ë‹¬ë¼ì§„ë‹¤.

### ê°€ë…ì„±
í•„ìš”í•œ ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ API í˜¸ì¶œì„ í•œë‹¤ê³  ê°€ì •í•˜ì.
í•˜ì§€ë§Œ í•´ë‹¹ APIë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë°ì´í„° ë˜í•œ ìš”ì²­ì„ í†µí•´ ì–»ì–´ì•¼í•œë‹¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í˜•íƒœì˜ ì½”ë“œê°€ êµ¬ì„±ëœë‹¤.
```typescript
listen("click", function handler(e) {
    ajax("https://some.url.1", (res) => {
        // calculate response data
        const result = calculatedData;
        
        ajax(`https://some.url.2?someData=${result}`, (res) => {
            console.log('í™œìš©í•  ë°ì´í„°: ', res)  
        })
    })
})
```
ì¡°ê¸ˆ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê¸°ëŠ” í•˜ì§€ë§Œ, ê·¸ë˜ë„ ì•„ì§ê¹Œì§€ëŠ” ì´í•´í•˜ê¸° í¬ê²Œ ì–´ë µì§€ ì•Šë‹¤.
í•˜ì§€ë§Œ í˜„ì¬ ì½”ë“œëŠ” ì—ëŸ¬ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì•˜ë‹¤. API í˜¸ì¶œì´ ì‹¤íŒ¨í•  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì— ì´ ë¶€ë¶„ë„ ì¶”ê°€í•´ë³´ì.
```typescript
listen("click", function handler(e) {
    ajax("https://some.url.1", (res) => {
        // calculate response data
        const result = calculatedData;
        
        ajax(`https://some.url.2?someData=${result}`, (res) => {
            console.log('í™œìš©í•  ë°ì´í„°: ', res)
        }, (err) => {
            console.error('https://some.url.2', err)
        })
    }, (err) => {
        console.error('https://some.url.1', err)
    })
})
```
ì—ëŸ¬ë¥¼ ë¶„í•  ì½œë°±ìœ¼ë¡œ ì œê³µí•œë‹¤ê³  í–ˆì„ ë•Œ ì—ëŸ¬ ìš°ì„  ì½œë°±ë³´ë‹¤ëŠ” ê·¸ë‚˜ë§ˆ ë‚«ì§€ë§Œ ì´ì¡°ì°¨ë„ ë¨¸ë¦¬ê°€ ì¡°ê¸ˆì”© ì–´ì§€ëŸ¬ì›Œì§„ë‹¤.
ì´ ìƒí™©ì—ì„œ ë˜ ë‹¤ë¥¸ APIê°€ ì¶”ê°€ëœë‹¤ê³  í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ í•¨ìˆ˜ë¥¼ ë‚˜ëˆ„ë ¤ëŠ” ì‹œë„ë¥¼ í•˜ê²Œ ëœë‹¤.
```typescript
listen("click", function handler(e) {
    someUrl1((res1) => someUrl2(res1, (res2) => someUrl3(res2, (res3) => {
        console.log('ë‚´ê°€ í•„ìš”í•œ ë°ì´í„°: ', res3)
    })))
})

function someUrl1(callback) {
    ajax("https://some.url.1", (res) => {
        // calculate response data
        const result = calculatedData;
        callback(result)
    }, (err) => {
        console.error('https://some.url.1', err)
    })
}

function someUrl2(params, callback) {
    ajax(`https://some.url.2?someData=${params}`, (res) => {
        // calculate response data
        const result = calculatedData;
        callback(result)
    }, (err) => {
        console.error('https://some.url.2', err)
    })
}

function someUrl3(params, callback) {
    ajax(`https://some.url.3?someData=${params}`, (res) => {
        // calculate response data
        const result = calculatedData;
        callback(result)
    }, (err) => {
        console.error('https://some.url.2', err)
    })
}
```
someUrl1 -> someUrl2 -> someUrl3 í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ê²°êµ­ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì–»ê¸´í–ˆì§€ë§Œ
ê° í•¨ìˆ˜ì—ì„œëŠ” ì–´ë–¤ ì²˜ë¦¬ë¥¼ í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” ì—ë””í„°ë¥¼ ì´ë¦¬ì €ë¦¬ ì˜®ê²¨ê°€ë©° í™•ì¸í•´ì•¼ í•œë‹¤. ì½”ë“œì— ìµìˆ™ì¹˜ ì•Šë‹¤ë©´
ì´ íë¦„ì„ íŒŒì•…í•˜ê³  ë”°ë¼ê°€ëŠ” ë°ì— ë” ë§ì€ ì–´ë ¤ì›€ì„ ê²ªì„ ê²ƒì´ë‹¤. ì •ë¦¬í•˜ìë©´, ì½œë°±ì„ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬ëŠ”
ë¹„ë™ê¸°ì˜ íë¦„ì„ **ë¹„ì„ í˜•ì , ë¹„ìˆœì°¨ì ì¸ ë°©í–¥**ìœ¼ë¡œ ë‚˜íƒ€ë‚´ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ì´í•´í•˜ê¸° ì–´ë µë‹¤.

### ì œì–´ì˜ ì—­ì „
ì½ì–´ë³¼ ê²ƒ [ë§í¬](https://dailylearn.hashnode.dev/callback-hell-and-inversion-of-control)

# Promise


ì½œë°±ì€ ì œì–´ì˜ ì—­ì „ì´ë¼ê³  í–ˆëŠ”ë°, í”„ë¼ë¯¸ìŠ¤ë¥¼ í†µí•´ ë‹¤ì‹œ ì œì–´ê¶Œì„ íšë“í•˜ê²Œ ë˜ì—ˆë‹¤.
PromiseëŠ” ê·€ê²°ë˜ê³ ë‚˜ë©´ ì™¸ë¶€ì ìœ¼ë¡œ ë¶ˆë³€ìƒíƒœì´ë¯€ë¡œ ë³€ê²½ë  ì¼ì€ ì—†ë‹¤. ì´ ë§ì€ promiseì˜ ìƒíƒœê°€ resolved í˜¹ì€ rejectedë¡œ ê·€ê²°ë˜ê³  ë‚˜ë©´ ë‹¤ë¥¸ ìƒíƒœë¡œ ë°”ë€” ì¼ì´ ì—†ë‹¤ëŠ” ë§ì´ë‹¤.
```typescript
new Promise((resolve, reject) => {
    resolve('ì™„ë£Œ')
    
    reject('ì™„ë£Œ ì•„ë‹Œë°?') // ë¬´ì‹œë¨
    resolve('ë°ì´í„° ë°”ê¿€ê±´ë°?') // ë¬´ì‹œë¨
})
```
1. 
2. 


ê¶ê¸ˆí•œ ë¶€ë¶„
1. í”„ë¼ë¯¸ìŠ¤ëŠ” ê·€ê²°ë˜ê³  ë‚˜ë©´ ì™¸ë¶€ì ìœ¼ë¡œ ë¶ˆë³€ ìƒíƒœì´ë¯€ë¡œ ì‚¬ê³ ë¡œ ë˜ëŠ” ì•…ì˜ì ìœ¼ë¡œ ë³€ê²½ë˜ëŠ” ì¼ì€ ì—†ë‹¤. ì–´ë–»ê²Œ?
2. í”„ë¼ë¯¸ìŠ¤ë¥¼ êµ¬í˜„í•œ ë°©ë²•? ì–´ë–»ê²Œ êµ¬í˜„í–ˆì„ê¹Œ..? â†’ thenable duck typing. ë°ë„ˆë¸”ì— í•´ë‹¹í•˜ëŠ” ê°’ì€ ë¬´ì¡°ê±´ í”„ë¼ë¯¸ìŠ¤ ê·œê²©ì— ë§ë‹¤ê³  ê°„ì£¼í•˜ëŠ” ê²ƒ.

# ETC

## Web API

---

You Donâ€™t Know JS [thisì™€ ê°ì²´ í”„ë¡œí† íƒ€ì…, ë¹„ë™ê¸°ì™€ ì„±ëŠ¥]
https://ko.javascript.info/callbacks
https://ko.javascript.info/promise-basics
https://ko.javascript.info/event-loop
[https://inpa.tistory.com/entry/ğŸŒ-js-async](https://inpa.tistory.com/entry/%F0%9F%8C%90-js-async)
https://www.youtube.com/watch?v=8aGhZQkoFbQ
